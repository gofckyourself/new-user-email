# Welcome Email Automation Script

Этот скрипт на PowerShell автоматически отправляет приветственные письма новым пользователям Active Directory (AD), созданным за последние сутки. Скрипт использует SMTP-сервер для отправки электронных писем и выполняется по расписанию через Task Scheduler.

## Функциональность
- Определяет пользователей, созданных за последние сутки, на основе атрибута `whenCreated` в AD.
- Использует учетные данные для подключения к SMTP-серверу.
- Формирует и отправляет персонализированное приветственное письмо каждому новому пользователю.
- Выполняется автоматически через Windows Task Scheduler.

## Предварительные требования
Перед использованием скрипта убедитесь, что выполнены следующие требования:
1. **PowerShell 5.1 или выше.**
2. **Модули Active Directory:**
   - Модуль Active Directory должен быть установлен на машине.
   - Для установки выполните: 
     ```powershell
     Install-WindowsFeature RSAT-AD-PowerShell
     ```
3. **Доступ к SMTP-серверу:**
   - Укажите IP-адрес или DNS имя сервера.
   - Обеспечьте учетные данные для отправки писем (логин и пароль).

## Конфигурация скрипта
Перед запуском настройте следующие переменные в скрипте:
- `$SMTPServer` — адрес SMTP-сервера.
- `$SMTPPort` — порт SMTP (например, `587`).
- `$Username` — учетная запись отправителя (адрес электронной почты).
- `$Password` — пароль учетной записи отправителя.
  > ⚠️ **Рекомендация:** Храните пароль в более защищенном виде, например, в защищенном хранилище 
- `$OU` — организационная единица (OU) AD, в которой находятся пользователи.

### Пример настройки
```powershell
$SMTPServer = "smtp.example.com"
$SMTPPort = 587
$Username = "admin@example.com"
$Password = "your_secure_password"
$OU = "OU=Users,DC=example,DC=com"
```

### Настройка расписания через Task Scheduler
Откройте Task Scheduler (Планировщик заданий) в Windows.
1. Нажмите Create Basic Task... (Создать простую задачу).
2. Задайте имя задачи, например, Send Welcome Emails.
3. Выберите триггер:
   - Daily (Ежедневно) — чтобы скрипт выполнялся ежедневно.
   - Укажите время выполнения (например, 09:00).
4. Выберите действие:
   - Start a Program (Запустить программу).
   - В поле Program/script укажите PowerShell.exe
   - В поле Add arguments добавьте: -ExecutionPolicy Bypass -File "C:\Path\To\SendWelcomeEmails.ps1"
5. Нажмите Finish (Готово), чтобы сохранить задачу.

### Возможные улучшения
Хранение учетных данных в защищенном хранилище (например, Windows Credential Manager).
Добавление уведомлений об ошибках при выполнении скрипта.
Расширение фильтров для выбора пользователей по дополнительным критериям.

### Лицензия
Этот скрипт предоставляется "как есть" без каких-либо гарантий. Используйте на свой страх и риск.
